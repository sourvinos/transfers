<div id="header">
    <div id="title">
        <div id="navigation" *ngIf="isFormVisible">
            <button mat-mini-fab class="navigation">
                <mat-icon id="goBack" (click)="goBack()">arrow_back</mat-icon>
            </button>
        </div>
        <h1>Transfers</h1>
    </div>
    <div id="search-box">
        <form [formGroup]="form" class="ui form" autocomplete="off">
            <mat-form-field>
                <input type="text" matInput placeholder="Date" class="date" formControlName="dateIn" [appInputFormat]="'date'" id="dateIn">
            </mat-form-field>
            <button mat-flat-button class="primary" id="go" (click)="getTransfers()">Search</button>
        </form>
    </div>
</div>

<div id="content">
    <div id="empty">
        <div id="empty-content">
            <div *ngIf="queryResult.persons == null; then thenBlock else elseBlock"></div>
            <ng-template #thenBlock>
                <h3></h3>
            </ng-template>
            <ng-template #elseBlock>
                <h1 id="nothing">We found nothing for this date</h1>
            </ng-template>
        </div>
        <div id="footer">
            <mat-divider></mat-divider>
            <div id="buttons">
                <p class="form-value" [class.hidden]=true>{{ form.value | json }} {{ form.valid }}</p>
                <button mat-flat-button class="delete" [class.hidden]="!id" id="delete" (click)="deleteRecord()">Delete</button>
                <button mat-flat-button class="primary" id="new" [disabled]="queryResult.persons == undefined" (click)="newRecord()">New</button>
            </div>
        </div>
    </div>
    <div id="summaries">
        <div class="summaryBlock">
            <div class="summaryHeader">
                <header>Destinations</header>
                <header class="total">{{ queryResult.persons }}</header>
            </div>
            <div *ngFor="let item of queryResult.personsPerDestination" (click)="toggleItem(item, this.selectedDestinations)" class="item destination" [class.active]="item.isSelected" [id]="item.description">
                <div class="description"> {{ item.description }} </div>
                <div class="total"> {{ item.persons }} </div>
            </div>
        </div>
        <div class="summaryBlock">
            <div class="summaryHeader">
                <header>Customers</header>
                <header class="total">{{ queryResult.persons }}</header>
            </div>
            <div *ngFor="let item of queryResult.personsPerCustomer" (click)="toggleItem(item, this.selectedCustomers)" class="item customer" [class.active]="item.isSelected" [id]="item.description">
                <div class="description"> {{ item.description }} </div>
                <div class="total"> {{ item.persons }} </div>
            </div>
        </div>
        <div class="summaryBlock">
            <div class="summaryHeader">
                <header>Routes</header>
                <header class="total">{{ queryResult.persons }}</header>
            </div>
            <div *ngFor="let item of queryResult.personsPerRoute" (click)="toggleItem(item, this.selectedRoutes)" class="item route" [class.activeItem]="item.isSelected" [id]="item.description">
                <div class="description"> {{ item.description }} </div>
                <div class="total"> {{ item.persons }} </div>
            </div>
        </div>
        <div class="summaryBlock">
            <div class="summaryHeader">
                <header>Drivers</header>
                <header class="total">{{ queryResult.persons }}</header>
            </div>
            <div *ngFor="let item of queryResult.personsPerDriver" (click)="toggleItem(item, this.selectedDrivers)" class="item driver" [class.active]="item.isSelected" [id]="item.description">
                <div class="description"> {{ item.description }} </div>
                <div class="total"> {{ item.persons }} </div>
            </div>
        </div>
        <div class="summaryBlock">
            <div class="summaryHeader">
                <header>Ports</header>
                <header class="total">{{ queryResult.persons }}</header>
            </div>
            <div *ngFor="let item of queryResult.personsPerPort" (click)="toggleItem(item, this.selectedPorts)" class="item port" [class.active]="item.isSelected" [id]="item.description">
                <div class="description"> {{ item.description }} </div>
                <div class="total"> {{ item.persons }} </div>
            </div>
        </div>
    </div>
    <div id="list">
        <div class="scrollable">
            <mat-table [dataSource]="dataSource" id="dataTable">
                <ng-container *ngFor="let column of columns; index as i" [matColumnDef]="columns[i]">
                    <mat-header-cell *matHeaderCellDef>{{ fields[i] }}</mat-header-cell>
                    <mat-cell *matCellDef=" let element" ngClass="{{ align[i] }}">{{ element[columns[i]] | custom:format[i] }}</mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="columns; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: columns;" [id]="row.id" [matRowKeyboardSelection]="selection" [rowModel]="row" [selectOnFocus]="true" [toggleOnEnter]="false" [ngClass]="{selected: selection.isSelected(row)}" (enter)="editRecord()" (dblclick)="editRecord()"></mat-row>
            </mat-table>
        </div>
        <div id="footer">
            <mat-divider></mat-divider>
            <div id="buttons">
                <button mat-flat-button class="primary" id="new" [disabled]="queryResult.persons == undefined" (click)="newRecord()">New</button>
            </div>
        </div>
    </div>
    <div id="form">
        <app-transfer-form #transfer></app-transfer-form>
    </div>
</div>